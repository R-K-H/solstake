!function(){function e(e){return e&&e.__esModule?e.default:e}var n=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire98dc;n.register("8MHMp",(function(t,r){var i,o,s,a,u;i=t.exports,Object.defineProperty(i,"__esModule",{value:!0,configurable:!0}),o=t.exports,s="default",a=function(){return v},u=function(e){return v=e},Object.defineProperty(o,s,{get:a,set:u,enumerable:!0,configurable:!0});var c=n("gTaKp"),d=n("bbCRF"),l=n("IG7SQ"),p=n("b9Sku"),f=n("jknvx"),h=function(e,n,t,r){return new(t||(t=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,a)}u((r=r.apply(e,n||[])).next())}))},v=function(n){"use strict";c.inherits(r,n);var t=c.createSuper(r);function r(e,n){var i;if(c.classCallCheck(this,r),(i=t.call(this))._network=n,i._publicKey=null,i._popup=null,i._handlerAdded=!1,i._nextRequestId=1,i._autoApprove=!1,i._responsePromises=new Map,i.handleMessage=function(e){var n;if(i._injectedProvider&&e.source===window||e.origin===(null===(n=i._providerUrl)||void 0===n?void 0:n.origin)&&e.source===i._popup)if("connected"===e.data.method){var t=new p.PublicKey(e.data.params.publicKey);i._publicKey&&i._publicKey.equals(t)||(i._publicKey&&!i._publicKey.equals(t)&&i.handleDisconnect(),i._publicKey=t,i._autoApprove=!!e.data.params.autoApprove,i.emit("connect",i._publicKey))}else if("disconnected"===e.data.method)i.handleDisconnect();else if(e.data.result||e.data.error){var r=i._responsePromises.get(e.data.id);if(r){var o=c.slicedToArray(r,2),s=o[0],a=o[1];e.data.result?s(e.data.result):a(new Error(e.data.error))}}},i._beforeUnload=function(){i.disconnect()},function(e){return function(e){return"object"==typeof e&&null!==e}(e)&&"postMessage"in e&&"function"==typeof e.postMessage}(e))i._injectedProvider=e;else{if(!function(e){return"string"==typeof e}(e))throw new Error("provider parameter must be an injected provider or a URL string.");i._providerUrl=new URL(e),i._providerUrl.hash=new URLSearchParams({origin:window.location.origin,network:i._network}).toString()}return i}return c.createClass(r,[{key:"handleConnect",value:function(){var e,n=this;if(this._handlerAdded||(this._handlerAdded=!0,window.addEventListener("message",this.handleMessage),window.addEventListener("beforeunload",this._beforeUnload)),this._injectedProvider)return new Promise((function(e){n.sendRequest("connect",{}),e()}));var t=this;return window.name="parent",this._popup=window.open(null===(e=this._providerUrl)||void 0===e?void 0:e.toString(),"_blank","location,resizable,width=460,height=675"),new Promise((function(e){t.once("connect",e)}))}},{key:"handleDisconnect",value:function(){var e=this;this._handlerAdded&&(this._handlerAdded=!1,window.removeEventListener("message",this.handleMessage),window.removeEventListener("beforeunload",this._beforeUnload)),this._publicKey&&(this._publicKey=null,this.emit("disconnect")),this._responsePromises.forEach((function(n,t){var r=c.slicedToArray(n,2)[1];e._responsePromises.delete(t),r(new Error("Wallet disconnected"))}))}},{key:"sendRequest",value:function(n,t){return h(this,void 0,void 0,e(d).mark((function r(){var i,o;return e(d).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this,"connect"===n||this.connected){e.next=3;break}throw new Error("Wallet not connected");case 3:return o=this._nextRequestId,++this._nextRequestId,e.abrupt("return",new Promise((function(e,r){var s,a,u,c;i._responsePromises.set(o,[e,r]),i._injectedProvider?i._injectedProvider.postMessage({jsonrpc:"2.0",id:o,method:n,params:Object.assign({network:i._network},t)}):(null===(s=i._popup)||void 0===s||s.postMessage({jsonrpc:"2.0",id:o,method:n,params:t},null!==(u=null===(a=i._providerUrl)||void 0===a?void 0:a.origin)&&void 0!==u?u:""),i.autoApprove||null===(c=i._popup)||void 0===c||c.focus())})));case 6:case"end":return e.stop()}}),r,this)})))}},{key:"publicKey",get:function(){return this._publicKey}},{key:"connected",get:function(){return null!==this._publicKey}},{key:"autoApprove",get:function(){return this._autoApprove}},{key:"connect",value:function(){return h(this,void 0,void 0,e(d).mark((function n(){return e(d).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._popup&&this._popup.close(),e.next=3,this.handleConnect();case 3:case"end":return e.stop()}}),n,this)})))}},{key:"disconnect",value:function(){return h(this,void 0,void 0,e(d).mark((function n(){return e(d).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._injectedProvider){e.next=3;break}return e.next=3,this.sendRequest("disconnect",{});case 3:this._popup&&this._popup.close(),this.handleDisconnect();case 5:case"end":return e.stop()}}),n,this)})))}},{key:"sign",value:function(n,t){return h(this,void 0,void 0,e(d).mark((function r(){var i,o,s;return e(d).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n instanceof Uint8Array){r.next=2;break}throw new Error("Data must be an instance of Uint8Array");case 2:return r.next=4,this.sendRequest("sign",{data:n,display:t});case 4:return i=r.sent,o=e(f).decode(i.signature),s=new p.PublicKey(i.publicKey),r.abrupt("return",{signature:o,publicKey:s});case 8:case"end":return r.stop()}}),r,this)})))}},{key:"signTransaction",value:function(n){return h(this,void 0,void 0,e(d).mark((function t(){var r,i,o;return e(d).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sendRequest("signTransaction",{message:e(f).encode(n.serializeMessage())});case 2:return r=t.sent,i=e(f).decode(r.signature),o=new p.PublicKey(r.publicKey),n.addSignature(o,i),t.abrupt("return",n);case 7:case"end":return t.stop()}}),t,this)})))}},{key:"signAllTransactions",value:function(n){return h(this,void 0,void 0,e(d).mark((function t(){var r,i,o;return e(d).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sendRequest("signAllTransactions",{messages:n.map((function(n){return e(f).encode(n.serializeMessage())}))});case 2:return r=t.sent,i=r.signatures.map((function(n){return e(f).decode(n)})),o=new p.PublicKey(r.publicKey),n=n.map((function(e,n){return e.addSignature(o,i[n]),e})),t.abrupt("return",n);case 7:case"end":return t.stop()}}),t,this)})))}},{key:"diffieHellman",value:function(n){return h(this,void 0,void 0,e(d).mark((function t(){var r;return e(d).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n instanceof Uint8Array){e.next=2;break}throw new Error("Data must be an instance of Uint8Array");case 2:return e.next=4,this.sendRequest("diffieHellman",{publicKey:n});case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),t,this)})))}}]),r}(e(l))}))}();
//# sourceMappingURL=esm.dc725fef.js.map
